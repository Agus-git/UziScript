as yet unclassified
compileTestMethods
	| selectorTemplate template selectors autogenCategory |
	selectorTemplate := 'test{1}{2}ShouldImplementAllVisitMethods'.
	template := selectorTemplate, '
	| errors selectors |
	selectors := self allSelectorsFor: {2}.
	errors := self missingNodes: selectors.
	self assert: errors isEmpty
		description: ''{2} is missing some critical methods'''.
	selectors := Set new.
	autogenCategory := 'autogenerated-tests'.
	
	"Compile test methods for all the subclasses"
	self root withAllSubclasses withIndexDo: [:class :index || selector src |
		selector := selectorTemplate format: { index printStringPadded: 3 . class name }.
		src := template format: { index printStringPadded: 3 . class name }.
		(self sourceCodeAt: selector asSymbol ifAbsent: [nil]) = src
			ifFalse: [self compile: src classified: autogenCategory.].
		selectors add: selector].
	
	"Then remove obsolete test methods"
	(self allTestSelectors
		select: [:sel | (selectors includes: sel) not
			and: [(self whichCategoryIncludesSelector: sel) = autogenCategory]])
		do: [:sel | self removeSelector: sel]
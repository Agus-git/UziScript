as yet unclassified
compileTestMethods
	| template selectors autogenCategory |
	template := 'test{1}{2}ShouldImplementAllVisitMethods
	| errors selectors |
	selectors := self allSelectorsFor: {2}.
	errors := self missingNodes: selectors.
	self assert: errors isEmpty
		description: ''{2} is missing some critical methods'''.
	selectors := Set new.
	autogenCategory := 'autogenerated-tests'.
	
	"Compile test methods for all the subclasses"
	self root withAllSubclasses withIndexDo: [:class :index || selector |
		selector := self 
			compile: (template format: { index printStringPadded: 3 . class name })
			classified: autogenCategory.
		selectors add: selector].
	
	"Then remove obsolete test methods"
	(self allTestSelectors
		select: [:sel | (selectors includes: sel) not
			and: [(self whichCategoryIncludesSelector: sel) = autogenCategory]])
		do: [:sel | self removeSelector: sel]